{% extends 'base.html' %}

{% block content %}
  <div class='col-sm-6 col-sm-offset-3'>
    <h1>{{ title }} </h1>

    <form method='GET' action=''>
      <input type='text' name='q' placeholder="Search posts" value='{{ request.GET.q }}'>
      <input type='submit' value='Search'>
    </form>

    <div class="row">
      {% for post in posts %}
        <div class="col-sm-12">
          <div class="thumbnail">
            {% if post.image %}
              <img src='{{ post.image.url }}' class='img-responsive'>
            {% endif %}
            <div class="caption">
              {% if post.draft %} <h3>Draft</h3> {% endif%} {% if post.publish > today %} <h3>Future Post</h3> {% endif %}
              <h3><a href='{{ post.get_absolute_url }}'> Link {{ post.title }}</a> <small> {{ post.timestamp|timesince }} ago </small></h3>
              <p>Author: {{ post.user }}</p>
              <p> {{ post.content|linebreaks|truncatechars:120 }} </p>
              <p>
                <a href="{{ post.get_absolute_url }}" class="btn btn-primary" role="button">View</a> 
              </p>
            </div>
          </div>
          <hr/>  
        </div>
      <!-- Every two loops there a new row is created  -->
      <!-- {% cycle "" "<div class='col-sm-12'><hr/></div></div><div class='row'>" %} -->
      {% endfor %}   
      <div class='pagination'>
        <span class='step-links'>
          {% if posts.has_previous %}
            <a href='?{{ page_request_var }}=1'>&laquo; first</a>
            <a href='?{{ page_request_var }}={{ posts.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }} {% endif %}'>previous</a>
          {% endif %}
          <span class='current'>
            Page {{ posts.number }} of {{ posts.paginator.num_pages }}.
          </span>
          {% if posts.has_next %}
            <a href='?{{ page_request_var }}={{ posts.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }} {% endif %}'>next</a>
            <a href='?{{ page_request_var }}={{ posts.paginator.num_pages }}'>last &raquo;</a>
          {% endif %}
        </span>
      </div>
    </div>
  </div>
{% endblock content %}